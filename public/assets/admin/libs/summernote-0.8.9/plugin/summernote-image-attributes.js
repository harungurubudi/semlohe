!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof module&&module.exports?module.exports=t(require("jquery")):t(window.jQuery)}(function(t){t.extend(!0,t.summernote.lang,{"en-US":{imageAttributes:{dialogTitle:"Image Attributes",tooltip:"Image Attributes",tabImage:"Image",src:"Source",browse:"Browse",title:"Title",alt:"Alt Text",dimensions:"Dimensions",tabAttributes:"Attributes",class:"Class",style:"Style",role:"Role",tabLink:"Link",linkHref:"URL",linkTarget:"Target",linkTargetInfo:"Options: _self, _blank, _top, _parent",linkClass:"Class",linkStyle:"Style",linkRel:"Rel",linkRelInfo:"Options: alternate, author, bookmark, help, license, next, nofollow, noreferrer, prefetch, prev, search, tag",linkRole:"Role",tabUpload:"Upload",upload:"Upload",tabBrowse:"Browse",editBtn:"OK"}}}),t.extend(t.summernote.options,{imageAttributes:{icon:'<i class="note-icon-pencil"/>',removeEmpty:!0,disableUpload:!1,imageFolder:""}}),t.extend(t.summernote.plugins,{imageAttributes:function(e){var i=this,o=t.summernote.ui,l=e.layoutInfo.note,a=e.layoutInfo.editor,n=e.layoutInfo.editable,r=e.options,s=r.langInfo,u="";if(r.maximumImageFileSize){var g=Math.floor(Math.log(r.maximumImageFileSize)/Math.log(1024)),m=1*(r.maximumImageFileSize/Math.pow(1024,g)).toFixed(2)+" "+" KMGTP"[g]+"B";u='<small class="help-block note-help-block">'+s.image.maximumFileSize+" : "+m+"</small>"}e.memo("button.imageAttributes",function(){return o.button({contents:r.imageAttributes.icon,tooltip:s.imageAttributes.tooltip,container:!1,click:function(){e.invoke("imageAttributes.show")}}).render()}),this.initialize=function(){var e=r.dialogsInBody?t(document.body):a,i=Date.now(),l='<ul class="nav note-nav nav-tabs note-nav-tabs" role="tablist">  <li class="active"><a href="#note-imageAttributes'+i+'" data-toggle="tab">'+s.imageAttributes.tabImage+'</a></li>  <li><a href="#note-imageAttributes-attributes'+i+'" data-toggle="tab">'+s.imageAttributes.tabAttributes+'</a></li>  <li><a href="#note-imageAttributes-link'+i+'" data-toggle="tab">'+s.imageAttributes.tabLink+"</a></li>";0==r.imageAttributes.disableUpload&&(l+='  <li><a href="#note-imageAttributes-upload'+i+'" data-toggle="tab">'+s.imageAttributes.tabUpload+"</a></li>"),l+='</ul><div class="tab-content note-tab-content">  <div class="tab-pane note-tab-pane" id="note-imageAttributes-attributes'+i+'">    <div class="note-form-group form-group note-group-imageAttributes-class">      <label class="control-label note-form-label">'+s.imageAttributes.class+'</label>      <div class="input-group note-input-group">        <input class="note-imageAttributes-class form-control note-form-control note-input" type="text">      </div>    </div>    <div class="note-form-group form-group note-group-imageAttributes-style">      <label class="control-label note-form-label">'+s.imageAttributes.style+'</label>      <div class="input-group note-input-group">        <input class="note-imageAttributes-style form-control note-form-control note-input" type="text">      </div>    </div>    <div class="note-form-group form-group note-group-imageAttributes-role">      <label class="control-label note-form-label">'+s.imageAttributes.role+'</label>      <div class="input-group note-input-group">        <input class="note-imageAttributes-role form-control note-form-control note-input" type="text">      </div>    </div>  </div>  <div class="tab-pane note-tab-pane" id="note-imageAttributes-link'+i+'">    <div class="note-form-group form-group note-group-imageAttributes-link-href">      <label class="control-label note-form-label col-xs-3">'+s.imageAttributes.linkHref+'</label>      <div class="input-group note-input-group">        <input class="note-imageAttributes-link-href form-control note-form-control note-input" type="text">      </div>    </div>    <div class="note-form-group form-group note-group-imageAttributes-link-target">      <label class="control-label note-form-label col-xs-3">'+s.imageAttributes.linkTarget+'</label>      <div class="input-group note-input-group">        <input class="note-imageAttributes-link-target form-control note-form-control note-input" type="text">      </div>      <small class="help-block note-help-block text-right">'+s.imageAttributes.linkTargetInfo+'</small>    </div>    <div class="note-form-group form-group note-group-imageAttributes-link-class">      <label class="control-label note-form-label col-xs-3">'+s.imageAttributes.linkClass+'</label>      <div class="input-group note-input-group">        <input class="note-imageAttributes-link-class form-control note-form-control note-input" type="text">      </div>    </div>    <div class="note-form-group form-group note-group-imageAttributes-link-style">      <label class="control-label note-form-label col-xs-3">'+s.imageAttributes.linkStyle+'</label>      <div class="input-group note-input-group">        <input class="note-imageAttributes-link-style form-control note-form-control note-input" type="text">      </div>    </div>    <div class="note-form-group form-group note-group-imageAttributes-link-rel">      <label class="control-label note-form-label col-xs-3">'+s.imageAttributes.linkRel+'</label>      <div class="input-group note-input-group">        <input class="note-imageAttributes-link-rel form-control note-form-control note-input" type="text">      </div>      <small class="help-block note-help-block text-right">'+s.imageAttributes.linkRelInfo+'</small>    </div>    <div class="note-form-group form-group note-group-imageAttributes-link-role">      <label class="control-label note-form-label col-xs-3">'+s.imageAttributes.linkRole+'</label>      <div class="input-group note-input-group">        <input class="note-imageAttributes-link-role form-control note-form-control note-input" type="text">      </div>    </div>  </div>',0==r.imageAttributes.disableUpload&&(l+='  <div class="tab-pane note-tab-pane" id="note-imageAttributes-upload'+i+'">   <label class="control-label note-form-label col-xs-3">'+s.imageAttributes.upload+'</label>   <div class="input-group note-input-group">     <input class="note-imageAttributes-input form-control note-form-control note-input" type="file" name="files" accept="image/*" multiple="multiple" />'+u+"    </div>  </div>"),l+='  <div class="tab-pane note-tab-pane active" id="note-imageAttributes'+i+'">    <div class="note-form-group form-group note-group-imageAttributes-url">      <label class="control-label note-form-label">'+s.imageAttributes.src+'</label>      <div class="input-group note-input-group">        <input class="note-imageAttributes-src form-control note-form-control note-input" type="text" />      </div>    </div>    <div class="note-form-group form-group note-group-imageAttributes-title">      <label class="control-label note-form-label">'+s.imageAttributes.title+'</label>      <div class="input-group note-input-group">        <input class="note-imageAttributes-title form-control note-form-control note-input" type="text" />      </div>    </div>    <div class="note-form-group form-group note-group-imageAttributes-alt">      <label class="control-label note-form-label">'+s.imageAttributes.alt+'</label>      <div class="input-group note-input-group">        <input class="note-imageAttributes-alt form-control note-form-control note-input" type="text" />      </div>    </div>    <div class="note-form-group form-group note-group-imageAttributes-dimensions">      <label class="control-label note-form-label">'+s.imageAttributes.dimensions+'</label>      <div class="input-group note-input-group">        <input class="note-imageAttributes-width form-control note-form-control note-input" type="text" />        <span class="input-group-addon note-input-group-addon">x</span>        <input class="note-imageAttributes-height form-control note-form-control note-input" type="text" />      </div>    </div>  </div></div>',this.$dialog=o.dialog({title:s.imageAttributes.dialogTitle,body:l,footer:'<button href="#" class="btn btn-primary note-btn note-btn-primary note-imageAttributes-btn">'+s.imageAttributes.editBtn+"</button>"}).render().appendTo(e)},this.destroy=function(){o.hideDialog(this.$dialog),this.$dialog.remove()},this.bindEnterKey=function(t,e){t.on("keypress",function(t){13===t.keyCode&&e.trigger("click")})},this.bindLabels=function(){i.$dialog.find(".form-control:first").focus().select(),i.$dialog.find("label").on("click",function(){t(this).parent().find(".form-control:first").focus()})},this.show=function(){var a=t(n.data("target")),s={imgDom:a,title:a.attr("title"),src:a.attr("src"),alt:a.attr("alt"),width:a.attr("width"),height:a.attr("height"),role:a.attr("role"),class:a.attr("class"),style:a.attr("style"),imgLink:t(a).parent().is("a")?t(a).parent():null};this.showImageAttributesDialog(s).then(function(t){o.hideDialog(i.$dialog);var a=t.imgDom;if(r.imageAttributes.removeEmpty?(t.alt?a.attr("alt",t.alt):a.removeAttr("alt"),t.width?a.attr("width",t.width):a.removeAttr("width"),t.height?a.attr("height",t.height):a.removeAttr("height"),t.title?a.attr("title",t.title):a.removeAttr("title"),t.src?a.attr("src",t.src):a.attr("src","#"),t.class?a.attr("class",t.class):a.removeAttr("class"),t.style?a.attr("style",t.style):a.removeAttr("style"),t.role?a.attr("role",t.role):a.removeAttr("role")):(t.src?a.attr("src",t.src):a.attr("src","#"),a.attr("alt",t.alt),a.attr("width",t.width),a.attr("height",t.height),a.attr("title",t.title),a.attr("class",t.class),a.attr("style",t.style),a.attr("role",t.role)),a.parent().is("a")&&a.unwrap(),t.linkHref){var n="<a";t.linkClass&&(n+=' class="'+t.linkClass+'"'),t.linkStyle&&(n+=' style="'+t.linkStyle+'"'),n+=' href="'+t.linkHref+'" target="'+t.linkTarget+'"',t.linkRel&&(n+=' rel="'+t.linkRel+'"'),t.linkRole&&(n+=' role="'+t.linkRole+'"'),n+="></a>",a.wrap(n)}l.val(e.invoke("code")),l.change()})},this.showImageAttributesDialog=function(l){return t.Deferred(function(a){var s=i.$dialog.find(".note-imageAttributes-title"),u=i.$dialog.find(".note-imageAttributes-input"),g=i.$dialog.find(".note-imageAttributes-src"),m=i.$dialog.find(".note-imageAttributes-alt"),c=i.$dialog.find(".note-imageAttributes-width"),p=i.$dialog.find(".note-imageAttributes-height"),b=i.$dialog.find(".note-imageAttributes-class"),d=i.$dialog.find(".note-imageAttributes-style"),f=i.$dialog.find(".note-imageAttributes-role"),v=i.$dialog.find(".note-imageAttributes-link-href"),A=i.$dialog.find(".note-imageAttributes-link-target"),h=i.$dialog.find(".note-imageAttributes-link-class"),k=i.$dialog.find(".note-imageAttributes-link-style"),y=i.$dialog.find(".note-imageAttributes-link-rel"),x=i.$dialog.find(".note-imageAttributes-link-role"),w=i.$dialog.find(".note-imageAttributes-btn");v.val(),h.val(),k.val(),x.val(),A.val(),y.val(),l.imgLink&&(v.val(l.imgLink.attr("href")),h.val(l.imgLink.attr("class")),k.val(l.imgLink.attr("style")),x.val(l.imgLink.attr("role")),A.val(l.imgLink.attr("target")),y.val(l.imgLink.attr("rel"))),o.onDialogShown(i.$dialog,function(){e.triggerEvent("dialog.shown"),u.replaceWith(u.clone().on("change",function(){var i;r.callbacks.onImageUpload?e.triggerEvent("image.upload",this.files[0]):(i=this.files[0],t.Deferred(function(e){t.extend(new FileReader,{onload:function(t){var i=t.target.result;e.resolve(i)},onerror:function(){e.reject(this)}}).readAsDataURL(i)}).promise()).then(function(t){g.val(t)}).fail(function(){e.triggerEvent("image.upload.error")})}).val("")),w.click(function(t){t.preventDefault(),a.resolve({imgDom:l.imgDom,title:s.val(),src:g.val(),alt:m.val(),width:c.val(),height:p.val(),class:b.val(),style:d.val(),role:f.val(),linkHref:v.val(),linkTarget:A.val(),linkClass:h.val(),linkStyle:k.val(),linkRel:y.val(),linkRole:x.val()}).then(function(t){e.triggerEvent("change",n.html())})}),s.val(l.title),g.val(l.src),m.val(l.alt),c.val(l.width),p.val(l.height),b.val(l.class),d.val(l.style),f.val(l.role),i.bindEnterKey(w),i.bindLabels()}),o.onDialogHidden(i.$dialog,function(){w.off("click"),"pending"===a.state()&&a.reject()}),o.showDialog(i.$dialog)})}}})});